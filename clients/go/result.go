package client

import (
	"encoding/json"
	"fmt"
)

// Status of the job
type Status string

// StatusSucceeded indicates an analytics job was completed successfully
const StatusSucceeded Status = "SUCCEEDED"

// StatusFailed indicates an analytics job has failed
const StatusFailed Status = "FAILED"

// StatusInProgress indicates an analytics job is still ongoing
const StatusInProgress Status = "INPROGRESS"

// Result Set of an analytics job
type Result struct {
	ID            string      `json:"id"`
	Status        Status      `json:"status"`
	Result        interface{} `json:"result"`
	OriginalQuery QueryParams `json:"originalQuery"`
}

// ParseResult is a helper to parse the result that was generated by the
// anaytics api and put into storage.
func ParseResult(value []byte) (*Result, error) {
	var res Result
	if err := json.Unmarshal(value, &res); err != nil {
		return nil, fmt.Errorf("could not parse result set: %v", err)
	}

	return &res, nil
}
